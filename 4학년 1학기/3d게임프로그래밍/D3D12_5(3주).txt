#투영 변환

*원근투영변환
모델에 있는 모든 점 >> World좌표계 >> Cam좌표계 

이제 이 점들을 2D로 바꾸는 작업

Painter's Algorithm >> 대표적인예로 원근감
카메라를 기준으로 멀리있는 객체는 작게 가까운 객체는 크게 그린다.

2D는 >> Z축의 좌표가 0이된다.(표현 할 필요가 없다)

직각 삼각형 >> 수선의 발? >> 투영?

Near, Far

FOV 90도는..
카메라에서 지나가는 Z축을 기준으로 위 아래 45도

직각삼각형을 기준으로..
Z축 , 수선의발(Y축)

* 투영 좌표계 >> 2차원 좌표

카메라 좌표계 (x, y, z) >> (x/z, y/z, 1)
Z좌표가 1로 바뀌었으므로 빼버려도 됨(굳이 얘기할 필요가 없음)

-Z축을 그냥 없애면 직교투영, Z축을 기준으로 나누면 원근투영

-y/z OR x/z에서...
result == (+-)1 => (y == z)
result < (+-)1  => (y < z)
result > (+-)1  => (y > z) -> 화면에 안보이는 영역

카메라에서 볼수 있는 모든 영역의 투영 좌표는 -1.0~1.0이다.

카메라의 영역을 비스듬하게 점점 줄여나가면 결국 정사각형으로 표현이 될것이다. >> 그것이 바로 투영 좌표계
>> 조건 : FOV가 90도 일때

카메라에 정 가운데 존재하는 모든 점들 >> Z축 점들 
이 점들을 기준으로 카메라 좌표계를 나누어 주는 것이다.

원근 투영을 하면 생기는 성질
1. 3D를 2D로 바꿀 수 있다.
2. FOV가 90도 일때 Z축 점을 기준으로 나누어진 결과를 
|x', y'| <= 1로 카메라에서 보이는지 안보이는지를 구분할 수 있다.
3. 원근감을 표현할 수 있게 된다.

-Z축의 점이 점점 커질수록 카메라 좌표를 Z축 점을 기준으로 나누어줄때 
0에 수렴하게 된다.

하지만 실질적으로 상용화된 게임들은 FOV를 45 ~ 60 정도를 쓴다?

-Frame Rate를 높이기 위해 카메라가 바라보는 거리를 적게 설정하는 방법이 존재한다.
-고로 FOV에 따라서 Frame Rate가 달라질 수 있다.
-FOV 조절, 원평면 조절을 통해 Frame Rate를 좋아지게 할 수 있다.

-LOD(Level Of Detail)
멀리 있는것(작게) -> 대충(빠르게, 자세한 계산 X) 그려서 느낌만 줘도 		 됨 
가까이 있는것(크게) -> 자세하게(느리게) 그려야 됨

->Camera와 거리에 따라서 LOD 강도가 달라진다.

EX) SkyBox >> 매번 3D? 무모한짓 플레이어가 하늘을 디테일하게 보지		     않는다. 자세하게 그릴 필요가 없음.

**게임에서 가장 중요한 것은 Frame Rate**

*임의의 각도 FOV
-투영 평면과 카메라 사이의 거리(d)
(d = 1): 90도 FOV
Xproj = x / (z / d)
Yproj = y / (z / d)

d를 가지고 z를 나누었을때 투영 결과가 달라질 수 있다.
d의 값을 통해서 z의 의미를 달리 할 수 있게 된다.

1 / tan0

이러한 d를 이용하면 모든 FOV의 경우를 90도로 변경시켜
좋은 성질을 맞추어 줄 수 있다.

만약 FOV가 60도인 경우 d를 찾는 함수 f(x)=tanx 를 사용하여 
카메라 좌표 (x, y, z)에서 
(x, y, z/d)로 만들고 z나누기를 해준다.
이렇게 하면 FOV 60의 환경을 만족시킴과 동시에 FOV 90도일때의 나오는성질을 만족시켜 줄 수가 있다.

result : d = 1 / tan(FOV / 2)

직각 삼각형
tan30 = z / y
1 = (z / y) / tan30


#화면 좌표 변환

-투영 좌표 공간을 화면으로 매핑

*뷰포트
-모니터 화면 영역으로 옮기는 작업.



#투영 변환과 화면 좌표 변환

*ProjTrans >> Cam.xyz / Cam.z
*ScreenTrans 
>> 
ScreenX = pojVertex.x * (ViewportWidth/2) + ViewportLeft + (ViewportWidth/2);

ScreenX = -pojVertex.y * (ViewportHeight/2) + ViewportTop + (ViewportHeight/2);












